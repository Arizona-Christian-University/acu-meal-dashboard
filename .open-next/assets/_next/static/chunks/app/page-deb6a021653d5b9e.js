(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{42389:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>D});var s=a(95155),l=a(12115),r=a(35695);function n(e){let{title:t,value:a,subtitle:l,trend:r,icon:n}=e;return(0,s.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6 border border-gray-200 hover:shadow-lg transition-shadow",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-600 uppercase tracking-wide",children:t}),(0,s.jsx)("p",{className:"mt-2 text-3xl font-bold text-gray-900",children:a}),l&&(0,s.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:l}),r&&(0,s.jsx)("p",{className:"mt-1 text-xs text-green-600 font-medium",children:r})]}),n&&(0,s.jsx)("div",{className:"ml-4 text-blue-500",children:n})]})})}var i=a(83540),c=a(93504),o=a(94754),d=a(96025),x=a(16238),m=a(94517),u=a(24026),h=a(21374);function b(e){let{data:t,dataKeys:a,xAxisKey:l,title:r}=e;return(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 border border-gray-200",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:r}),(0,s.jsx)(i.u,{width:"100%",height:300,children:(0,s.jsxs)(c.b,{data:t,children:[(0,s.jsx)(o.d,{strokeDasharray:"3 3"}),(0,s.jsx)(d.W,{dataKey:l,tick:{fontSize:12}}),(0,s.jsx)(x.h,{tick:{fontSize:12}}),(0,s.jsx)(m.m,{}),(0,s.jsx)(u.s,{}),a.map(e=>(0,s.jsx)(h.N,{type:"monotone",dataKey:e.key,stroke:e.color,name:e.name,strokeWidth:2},e.key))]})})]})}var g=a(3401),j=a(83394);function y(e){let{data:t,dataKey:a,xAxisKey:l,title:r,color:n="#3b82f6"}=e;return(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 border border-gray-200",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:r}),(0,s.jsx)(i.u,{width:"100%",height:300,children:(0,s.jsxs)(g.E,{data:t,children:[(0,s.jsx)(o.d,{strokeDasharray:"3 3"}),(0,s.jsx)(d.W,{dataKey:l,tick:{fontSize:12},angle:-45,textAnchor:"end",height:100}),(0,s.jsx)(x.h,{tick:{fontSize:12}}),(0,s.jsx)(m.m,{}),(0,s.jsx)(u.s,{}),(0,s.jsx)(j.y,{dataKey:a,fill:n})]})})]})}var p=a(8782),f=a(34e3),v=a(54811);let N=["#3b82f6","#10b981","#f59e0b","#ef4444","#8b5cf6","#ec4899","#14b8a6","#f97316"];function w(e){let{data:t,title:a,colors:l=N}=e;return(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 border border-gray-200",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:a}),(0,s.jsx)(i.u,{width:"100%",height:300,children:(0,s.jsxs)(p.r,{children:[(0,s.jsx)(f.F,{data:t,cx:"50%",cy:"50%",labelLine:!1,label:e=>{let{name:t,percent:a}=e;return"".concat(t,": ").concat((100*a).toFixed(0),"%")},outerRadius:80,fill:"#8884d8",dataKey:"value",children:t.map((e,t)=>(0,s.jsx)(v.f,{fill:l[t%l.length]},"cell-".concat(t)))}),(0,s.jsx)(m.m,{}),(0,s.jsx)(u.s,{})]})})]})}function S(){return(0,s.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})})}function k(e){let{message:t}=e;return(0,s.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,s.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-lg",children:[(0,s.jsx)("h2",{className:"text-red-800 text-xl font-bold mb-2",children:"Error Loading Data"}),(0,s.jsx)("p",{className:"text-red-600",children:t})]})})}function D(){let e=(0,r.useRouter)(),[t,a]=(0,l.useState)(null),[i,c]=(0,l.useState)(null),[o,d]=(0,l.useState)(!0),[x,m]=(0,l.useState)(null),[u,h]=(0,l.useState)("Meal_Plan_Type"),[g,j]=(0,l.useState)("Meal_Plan_Type"),[p,f]=(0,l.useState)("Housing_Status"),v=async()=>{try{await fetch("/api/auth/logout",{method:"POST"}),e.push("/login"),e.refresh()}catch(e){console.error("Logout failed:",e)}};(0,l.useEffect)(()=>{N()},[u]),(0,l.useEffect)(()=>{D()},[g,p]);let N=async()=>{try{d(!0);let e=await fetch("/api/dashboard?cohortField=".concat(u),{credentials:"include"});if(!e.ok)throw Error("Failed to fetch dashboard data");let t=await e.json();a(t),m(null)}catch(e){m(e.message)}finally{d(!1)}},D=async()=>{try{let e=await fetch("/api/crosstab?dimension1=".concat(g,"&dimension2=").concat(p),{credentials:"include"});if(!e.ok)throw Error("Failed to fetch crosstab data");let t=await e.json();c(t)}catch(e){console.error("Error fetching crosstab data:",e)}};if(o)return(0,s.jsx)(S,{});if(x)return(0,s.jsx)(k,{message:x});if(!t)return(0,s.jsx)(k,{message:"No data available"});let{metrics:A,timeSeries:T,cohortAnalysis:M,usagePatterns:K,deniedTransactions:P}=t,E=Object.entries(A.mealPlanDistribution).map(e=>{let[t,a]=e;return{name:t,value:a}}),F=Object.entries(A.housingDistribution).map(e=>{let[t,a]=e;return{name:t,value:a}}),_=Object.entries(A.genderDistribution).map(e=>{let[t,a]=e;return{name:t,value:a}}),O=Object.entries(A.raceDistribution).map(e=>{let[t,a]=e;return{name:t,value:a}}),C=Object.entries(K.byDayOfWeek).map(e=>{let[t,a]=e;return{name:t,count:a}}).sort((e,t)=>{let a=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"];return a.indexOf(e.name)-a.indexOf(t.name)}),L=Object.entries(K.byHour).map(e=>{let[t,a]=e;return{name:"".concat(t,":00"),count:a}}).sort((e,t)=>parseInt(e.name)-parseInt(t.name)),z=M.map(e=>({cohort:e.cohort,transactions:e.totalTransactions,avgPerPerson:Math.round(e.averagePerPerson)})),H=i?Object.entries(i.crosstab).flatMap(e=>{let[t,a]=e;return Object.entries(a).map(e=>{let[a,s]=e;return{[g]:t,[p]:a,count:s}})}):[],W=[{value:"Meal_Plan_Type",label:"Meal Plan Type"},{value:"Housing_Status",label:"Housing Status"},{value:"Is_Athlete",label:"Athlete Status"},{value:"Gender",label:"Gender"},{value:"Class",label:"Class Year"},{value:"IPEDS Race/Ethnicity",label:"Race/Ethnicity"}];return(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,s.jsx)("header",{className:"bg-blue-600 text-white shadow-lg",children:(0,s.jsx)("div",{className:"container mx-auto px-4 py-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold",children:"Arizona Christian University"}),(0,s.jsx)("p",{className:"text-blue-100 mt-1",children:"Meal Accounting Dashboard - Fall 2025"})]}),(0,s.jsx)("button",{onClick:v,className:"bg-blue-700 hover:bg-blue-800 text-white font-semibold py-2 px-6 rounded-lg transition",children:"Logout"})]})})}),(0,s.jsxs)("main",{className:"container mx-auto px-4 py-8",children:[(0,s.jsxs)("section",{className:"mb-8",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Key Metrics"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,s.jsx)(n,{title:"Total Students",value:A.totalStudents.toLocaleString(),subtitle:"Enrolled with meal plans"}),(0,s.jsx)(n,{title:"Total Transactions",value:A.totalTransactions.toLocaleString(),subtitle:"All meal and flex transactions"}),(0,s.jsx)(n,{title:"Meal Swipes",value:A.totalMealSwipes.toLocaleString(),subtitle:"Avg: ".concat(A.averageMealsPerStudent.toFixed(1)," per student")}),(0,s.jsx)(n,{title:"Flex Dollars Spent",value:"$".concat(A.totalFlexDollarsSpent.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})),subtitle:"Avg: $".concat(A.averageFlexPerStudent.toFixed(2)," per student")})]})]}),(0,s.jsxs)("section",{className:"mb-8",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Usage Trends"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,s.jsx)(b,{data:T.mealDaily,dataKeys:[{key:"count",color:"#3b82f6",name:"Meal Swipes"}],xAxisKey:"date",title:"Daily Meal Swipes"}),(0,s.jsx)(b,{data:T.flexDaily,dataKeys:[{key:"count",color:"#10b981",name:"Transactions"},{key:"amount",color:"#f59e0b",name:"Amount ($)"}],xAxisKey:"date",title:"Daily Flex Dollar Activity"})]})]}),(0,s.jsxs)("section",{className:"mb-8",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Usage Patterns"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,s.jsx)(y,{data:C,dataKey:"count",xAxisKey:"name",title:"Meal Swipes by Day of Week",color:"#3b82f6"}),(0,s.jsx)(y,{data:L,dataKey:"count",xAxisKey:"name",title:"Meal Swipes by Hour of Day",color:"#10b981"})]})]}),(0,s.jsxs)("section",{className:"mb-8",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Student Demographics"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,s.jsx)(w,{data:E,title:"Meal Plan Distribution"}),(0,s.jsx)(w,{data:F,title:"Housing Distribution"}),(0,s.jsx)(w,{data:_,title:"Gender Distribution"}),(0,s.jsx)(w,{data:O,title:"Race/Ethnicity Distribution"})]})]}),(0,s.jsxs)("section",{className:"mb-8",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Cohort Analysis"}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Analyze by:"}),(0,s.jsx)("select",{value:u,onChange:e=>h(e.target.value),className:"mt-1 block w-full md:w-64 pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 rounded-md",children:W.map(e=>(0,s.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,s.jsx)(y,{data:z,dataKey:"transactions",xAxisKey:"cohort",title:"Total Transactions by ".concat(u),color:"#8b5cf6"})]}),(0,s.jsxs)("section",{className:"mb-8",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Crosstab Analysis"}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 border border-gray-200",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Dimension 1:"}),(0,s.jsx)("select",{value:g,onChange:e=>j(e.target.value),className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 rounded-md",children:W.map(e=>(0,s.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Dimension 2:"}),(0,s.jsx)("select",{value:p,onChange:e=>f(e.target.value),className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 rounded-md",children:W.map(e=>(0,s.jsx)("option",{value:e.value,children:e.label},e.value))})]})]}),(0,s.jsxs)("div",{className:"overflow-x-auto",children:[(0,s.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,s.jsx)("thead",{className:"bg-gray-50",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:g}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:p}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Transaction Count"})]})}),(0,s.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:H.slice(0,20).map((e,t)=>(0,s.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e[g]}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e[p]}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.count.toLocaleString()})]},t))})]}),H.length>20&&(0,s.jsxs)("p",{className:"text-sm text-gray-500 mt-4 text-center",children:["Showing 20 of ",H.length," combinations"]})]})]})]}),P.count>0&&(0,s.jsxs)("section",{className:"mb-8",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Denied Transactions"}),(0,s.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[(0,s.jsxs)("p",{className:"text-red-800 font-semibold mb-2",children:["Total Denied: ",P.count]}),(0,s.jsxs)("p",{className:"text-red-600 text-sm",children:["There are ",P.count," denied transactions that may require attention."]})]})]})]}),(0,s.jsx)("footer",{className:"bg-gray-800 text-white mt-12",children:(0,s.jsx)("div",{className:"container mx-auto px-4 py-6",children:(0,s.jsx)("p",{className:"text-center text-sm",children:"\xa9 2025 Arizona Christian University - Meal Accounting Dashboard"})})})]})}},49338:(e,t,a)=>{Promise.resolve().then(a.bind(a,42389))}},e=>{e.O(0,[985,441,964,358],()=>e(e.s=49338)),_N_E=e.O()}]);